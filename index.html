<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lines to Name and Animal</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
    }
  </style>
</head>
<body>
  <script>
    let points = [];
    let nameFont;
    let phase = 0; // 0: lines forming name, 1: transition to animal
    let transitionProgress = 0;
    let animalPoints = [];

    function preload() {
      nameFont = loadFont('https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/RobotoMono-Regular.ttf'); // Load a custom font
    }

    function setup() {
      createCanvas(windowWidth, windowHeight);
      textFont(nameFont);

      // Generate points for the name "Sanu"
      let namePath = nameFont.textToPoints("Sanu", width / 4, height / 2, 200, {
        sampleFactor: 0.1,
      });
      points = namePath.map(p => ({
        x: p.x,
        y: p.y,
        originalX: p.x,
        originalY: p.y,
      }));

      // Generate random points for the "animal" (a circle for now, can be replaced with other shapes)
      for (let i = 0; i < points.length; i++) {
        let angle = map(i, 0, points.length, 0, TWO_PI);
        let radius = 150;
        let x = width / 2 + cos(angle) * radius;
        let y = height / 2 + sin(angle) * radius;
        animalPoints.push({ x, y });
      }
    }

    function draw() {
      background(0);

      // Phase 0: Lines forming the name
      if (phase === 0) {
        for (let i = 0; i < points.length; i++) {
          let p = points[i];
          stroke(255);
          strokeWeight(2);
          if (i > 0) {
            let prev = points[i - 1];
            line(prev.x, prev.y, p.x, p.y); // Draw lines connecting points
          }

          // Gradually form the name
          p.x = lerp(p.x, p.originalX, 0.05);
          p.y = lerp(p.y, p.originalY, 0.05);
        }

        // Transition to animal shape
        if (frameCount > 150) {
          phase = 1;
        }
      }

      // Phase 1: Transition to animal
      if (phase === 1) {
        transitionProgress += 0.02;
        for (let i = 0; i < points.length; i++) {
          let p = points[i];
          let target = animalPoints[i];
          stroke(0, 255, 0);
          strokeWeight(2);
          if (i > 0) {
            let prev = points[i - 1];
            line(prev.x, prev.y, p.x, p.y);
          }

          // Interpolate points to animal shape
          p.x = lerp(p.x, target.x, transitionProgress);
          p.y = lerp(p.y, target.y, transitionProgress);
        }

        // Stop the animation after the transition
        if (transitionProgress >= 1) {
          noLoop(); // Stops the draw loop once the animal shape is formed
        }
      }
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
    }
  </script>
</body>
</html>
